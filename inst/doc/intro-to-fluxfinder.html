<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to fluxfinder</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to fluxfinder</h1>



<p>The <code>fluxfinder</code> package provides functions to parse
static-chamber greenhouse gas measurement files generated by a variety
of instruments; compute flux rates using multi-observation metadata; and
generate diagnostic metrics and plots. Itâ€™s designed to be easy to
integrate into scientific workflows.</p>
<div id="load-sample-data" class="section level2">
<h2>Load sample data</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(fluxfinder)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Data from a LI-7810</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/TG10-01087.data&quot;</span>, <span class="at">package =</span> <span class="st">&quot;fluxfinder&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">ffi_read_LI7810</span>(f)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#&gt; TG10-01087.data: read 507 rows of TG10-01087 data, 2022-10-27 10:35:42 to 2022-10-27 10:44:08 EST</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># Note that the fluxfinder read functions print some info after reading</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># Set &quot;options(fluxfinder.quiet = TRUE)&quot; to suppress such messages</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co"># Look at a subset of the data; the full data frame has 500+ rows and 25 columns</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>dat[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt;   DATAH    SECONDS NANOSECONDS  NDX DIAG REMARK      H2O      CO2      CH4</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; 1  DATA 1666884942   313442945 4509    0     NA 12500.35 458.8612 2068.000</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; 2  DATA 1666884943   313442945 4513    0     NA 12449.87 458.1066 2069.830</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="co">#&gt; 3  DATA 1666884944   313442945 4517    0     NA 12418.81 458.7320 2071.540</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="co">#&gt; 4  DATA 1666884945   313442945 4521    0     NA 12429.65 458.8037 2071.960</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="co">#&gt; 5  DATA 1666884946   313442945 4525    0     NA 12439.89 458.2824 2069.660</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="co">#&gt; 6  DATA 1666884947   313442945 4529    0     NA 12429.37 456.9340 2066.544</span></span></code></pre></div>
<p>The data frame returned by <code>ffi_read_LI7810</code> is all data
from the raw <a href="https://www.licor.com/env/products/trace-gas/LI-7810">LI-7810</a>
file, except that <code>TIMESTAMP</code>, <code>TZ</code> (time zone of
the timestamps), <code>SN</code> (serial number), and <code>MODEL</code>
columns have been added.</p>
<p>The analyzer data is basically a stream of measured greenhouse gas
concentrations:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(TIMESTAMP, CO2)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="match-with-metadata" class="section level2">
<h2>Match with metadata</h2>
<p>For these data to be useful, we need to associate them with
<em>metadata</em> about the measurements: when they were started, how
long they lasted, plot/treatment/collar information, etc.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Accompanying metadata</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>md <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata/TG10-01087-metadata.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;fluxfinder&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>metadat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(md)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">print</span>(metadat)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;         Date Start_time Plot Obs_length</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 1 2022-10-27   10:35:30    A         60</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 2 2022-10-27   10:37:15    B         60</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 3 2022-10-27   10:39:00    C         60</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 4 2022-10-27   10:40:30    D         60</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 5 2022-10-27   10:42:00    E         60</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 6 2022-10-27   10:43:30    F         60</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; 7 2022-10-27   11:00:00    G         60</span></span></code></pre></div>
<p><strong>Important note</strong>: in this sample metadata, our
measurement identified is labeled <code>Plot</code>, but this could be
named, and refer to, anything: bottle, sample, collar, etc. Itâ€™s simply
an identifier for <em>this</em> measurement, i.e. this row.</p>
<p>The <code>ffi_metadata_match</code> function matches up the data with
metadata, using the <code>TIMESTAMP</code> column that
<code>ffi_read_LI7810</code> helpfully created when it read the data
file.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>dat<span class="sc">$</span>metadat_row <span class="ot">&lt;-</span> <span class="fu">ffi_metadata_match</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">data_timestamps =</span> dat<span class="sc">$</span>TIMESTAMP,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">start_dates =</span> metadat<span class="sc">$</span>Date,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">start_times =</span> metadat<span class="sc">$</span>Start_time,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">obs_lengths =</span> metadat<span class="sc">$</span>Obs_length <span class="sc">+</span> <span class="dv">10</span>) <span class="co"># 10 is expected dead band length</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 1 entry had no timestamp matches!</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># Note that ffi_metadata_match() warns us that one metadata row didn&#39;t match any data</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># Based on the row match information, add a &quot;Plot&quot; column to the data</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>dat<span class="sc">$</span>Plot <span class="ot">&lt;-</span> metadat<span class="sc">$</span>Plot[dat<span class="sc">$</span>metadat_row]</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>metadat<span class="sc">$</span>metadat_row <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(metadat))</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co"># ...and plot</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(TIMESTAMP, CO2, <span class="at">color =</span> Plot)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Some of these are clearly not correctâ€“the measurement time seems to
be shorter then 60 seconds for the C, D, and E plots:</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAEgCAMAAABcujGyAAAA/1BMVEUAAAAAADoAAGYAOpAAZrYAujgAv8QzMzM6AAA6ADo6AGY6OpA6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOpBmZmZmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+R/f3+OTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQkGaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2Zjq2tma225C22/+2/9u2//+3nwDIjk3I///bkDrbtmbb/7bb/9vb///kq27k///r6+v1ZOP4dm3/AAD/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///+cjZvlAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAck0lEQVR4nO2dC3sUN5aGDbE9TGIIMTOwa5KBJpngZGYgyQ7eGzaeXaDsNV5ju/7/b5mWVFJJpduRSlKVqs/3PNDtrvr61OVt3VXaalGoGWtr6gNAoVxCQFGzFgKKmrUQUNSshYCiZi0EFDVrIaCoWSsO0AasgF0TGetyVnWwXmdiOIkQ0GmdVR0sAprCWJezqoNFQFMY63JWdbAIaApjXc6qDhYBTWGsy1nVwSKgKYx1Oas6WAQ0hbEuZ1UHi4CmMNblLB9yf38/W8zEcBIhoNM6i4fc3x9BKAKawFiXEwH1CAGd1omAeoSAQp3/tykacWkTw0mEgEKdU3NTTCMubWI4iRBQmHNqagpqxKVNDCcRAgpzTk1NQY24tInhJEJAYc6Rdy69Md7pqiYhoPmNCKhH+w5CEdD8RgTUrf19B6EIaH4jAurWkgC9ff2y/XCfiL1+/Q4BTRyz9Gnu7y8J0A9rMIk+PfzYnryUNsAvSDV3zuNcCKAePisD9OpPf6ZUXn//pr395Q0CmiHmFIDmO82ygN7+8vfXFNAP36whfUEz+rV+t1aGA5m5yJ2b+hgSiAFq1/xO0wHoh+e3FFCSgLZX38qpKPwnW0vS4nMuIwV1Zu9ENaWgV88+MkBJCZRJlEPhl6SSO+d1LgJQd/mTqCZAWfX9+RrL5/wjBDR5zJKn6akgEdUEaMuambqMnSSjt79iM1PqmFMA2rK3pl1qBJQWQWmC+kBU5OEXpYo7B3AuBlDqtCaklQFqFfyiVHHnAM6lAMqc1qw+C6A3h1tEd161l79/JT79//9CQBM6FwDo/nSA7pGX07tvJUBlVhHQ8c5lAWrN43MC+vnRAQKazbkwQG3T4wsASjL87fby3tbWHgKazrkAQAWTpbs6O0CPaBZ/c7jdkn+YgqZ1LgFQjmh5QGkl6e5bQuXF+qW9UIqjCGgCZ/WASq30E6WgLS14Xnzxnr4ioGmdtQO6j4DGnVJ6IwJq0nwAvfMKs/gMzsUA6nbmB5RXktZ1egQ0obN2QOXJxpMC2jUzrSv19H8ENJGzekBhTuyLz2+c5Z1Lb5zlaSaGkwgBhTmXB2i5rs5RQkBhzsoBVfreW/GJth8Cmt+IgOpSh9KPAvTs7MyxPb0QUJgTAWXOszMXoYnhJEJAYc7FARpZBq0E0M3T/CaMB6mbjOSV9zQpoIHBR9GMKSjMWXcKqmboo07zzJWGIqCTORFQ4XQQioBO5qwYUIImAuo8pRghoImcjE25SoSADk8pRghoIqc+P27saWIZdJQRAVWlTzEu3RcftDMCGuesFtD9pIA6+5EQ0Amd1QMqERp/mmdnzlYmBHQ6JwJKdOYhNA7Qz39wzP5AQGHOagE15PHTAXp+fm7Y+eKJ4xEOGwHo8fHx2JjVAkrRTFkGHQHo+blMKN9889PfHr/faECPj4GELhBQ06ClMac5qgxqBvTyq/dH9gl0CCgsJgLaOdMDerrXXtjnz80R0NVqhYAmcuqNTBMCaiyD0gfjkOfhVAPoiincaA254WXQdD1JhM3w8aDundc5fNva8/i5AbrqFeiMDglyVguoIZePPk33aOUmDtBTwqY9j58ZoCsENK3T0JE0L0Bvfia5u70pFAGFOesE1NBK73YCAHURGgGoT/MFNMwYHxLmrBJQM59jG+pdx7R4QGkNHgFN5Fw8oPJ68dcv7oslEfM3M61W2NU53mnmc0GjmaT14imr35QBdGQSioB2Mk99z3mahQGV14u//uFde/VdiaUQR2fyCCiTjc/I0ySJ57wAVdaLv3r2sVsUMfN68VI1KWOUYFU4Lx44FV6R/TRjJsR3ygWosl48WUy2W7XTHtJ0FPBdmcbX4zEFZUqbgnqGKnffXBJQdb34PgXNCGifu2MZNIEzaRnUN5iefXNJQNX14kuUQRmWHZxYix/tXDigrbJe/O3r59lr8UriiYCOdqYE1DeWvvvmKQDtMvb87aBq5p7qzvGRTJARTcsCNGUZFMbnsnuSVlkAPWaCjQldFKBWPscA6jumDQI0US3+WFaQU1V1gFq6OT1OJ6Cza6ifClDxFzyMNeSmArq/bye0FbtomyynyVPPHICShbm3tmoYsKw0L6UCtAngc7MANW7LDKhyEzigX75tHYtzzwhQIkFlMkAlRIOdkqoE1FIOnQxQ9S7IgN78NHNA9ab5ZD1JcD6XBGizb5gQrzhDAOUTkbIBSicmzRhQQ+/R+DsnKu9MAOKXBqi5Eh9cBu2r71kApWXQLyoBtGdo9J07VgUpMywGUHsN3uM0nabUwJStDHpzaKslbQagzWYB6mhi8jjtgKbI4o07U0Dt846nB5RO5s8LKPlzEwENd04F6IxndfLHoWQpgw4IhToNqhHQCOcUgM68HbQDVEvgEty5gE5Ob8yaAPUkoIGneZawDArYeeMAhTYxeWJWBKinBBoFqN/Jti8QUEao3g6a4s6FdHN6YlYIaExMBFSXmc90KWgDJ3RBgEbGtJRBAU62fYGA9nymBrTnkr3ZmFq8h8+Mp7lAQC0Z/No4ui++TzehLfULAXSE05zFg2MuGtDBhvjRIjqgTZeAIqA+p36ayjjlagBNJwHocMPK9CFcXcEz2RcqE8Z3dnbij6yAwufDc+nz4kfMh+eaAFDPD0k+Ct8OlgR0ZApqqhglK4PuEIGd0SFjnZ46/EakoJ7jlI/CudXSBkqNo8qgQc2fitOiegD1NTJhGVQ9CtfGc9ZKbwYUHsPgREDjYmItvtc5lznzHXHnbB2cySpJGp85Ad3d3Q1yevkMzuJBTrZ9QYCeS4AGGb2y9R75S7VzrMXv7loIdZVBo2MOT3Mw2XgzATUTOmNA9QQ0N6AmREs0Mw1nwyOgAKNP1u73VIAaiqD5AdUJXQ6gF8ApH0fdgl8X9mW/EgLqy+Njr79jdEiiMmhZQK1JqKMMGh/TCCjIybZ7aFEuHN98Sng7shHaA0p2uSADRwsBypS6DBo4wA4csyigKo9hgHqrSOFlUJCTbXfTol65bisbTG+dlCQA/fzogP6/XRbQ1MbQIaDQmCXLoAqQoWXQAEAB044LAHphzd1NgK5J3l4IoBGEzqQWLxNp5dMS0t/IJJymPbXTVB8YlgVQ+0rHCqC8FPD5kWPp2fkDKs2GTxpzUkDhISF8BgEKiClv99BiKoPan9kwALQ9ukNn1t0cVg0odeYGVCuFZiuDWhPQKgE17QwtgwbJc5wBp5TYSLjsujrTxhz2JA0ITXyaEEJHAwopg0JiytsjAAXX4osDaq3A+4x2sSF2MU5fzKKA6rUkqLMB8Dm7vnhoOyiboXzHNoM+JaCETUc3p93oUXwLky/mVIDySpLehluioT7AybZHAeqUVga9vOeuVaUA1NcPbzX65AE0WV98MUAlPrU5MSYnIP2sFlDeutS1N1UJqLt25O3rhN+5IaEpAZVblvg7IKCQEmitgN4c7nXvTt0tpykBDTUapSSbrjJoHYDuGgA1zio0fFtSQA3LJkwJaJ9wZm+oh/AJv+Vywzz935qGVghoY+UzO6CmhT3mBihbyOv1/Qdv2MJzXydZaQ6SwRMjcM7HsUnmXROOB81XBjX0HUGnHMD4rBRQUxZP14s/eUlX6zx56Q9pOgr9o55PF6MtdNZcAKARB8tlLJz1lKYD1NTuCQQU1AhqdArNGFBDJYmuF08W6Wz5gogpAW3cDU1gQI2Ewg/Qc7BcJkB5Pk9mIccFtAKqE+p3+icj2Zy9+tM0Lt01j2YmnpKy9eKvnv1GsvjrF+ssniai49eLX2PJX7t3JoXNYxdo0rfjjs8kfcI4nR5PJsh3L4nUARpu7PgcF12cplj7cNz3UaUClDXU9zUktl781VMC6cerb99IqajnhwT8zblT0CZwYrxIOwu1YO/w5nrT+NARIbUqEtAJTkABp3nWC+pk2/MCqqpbL15eKF6UQwFXAXJKzjJo8KMbAIAmq8VLfKYFlCCpdiN1G3zNTN6HLtpjSmKnaeNzXoB268Vf/5gPULcx+NkiXkB93xgMqHibqgyqlj+lv7yP/4PzWS2gtHZ0cyg109NmphOaipKK/O2vSZqZoMZAQEXtqAigg+74MoC6nvALxhMK6HA0vcfJtucElNeOjvpSKFsv/gVt/1wnqA9ERR52ISCn5DKG8+kJmRpQkNMtxajV4JUc3gloAJ/CabgYwzKo62hN35wT0KPt4Ru7gFfCeEqeBnq70S0IoAnLoDlSUN6HBCN0NKCmn+sAUNfRGr85AlDoKh+lujr7NtBAo0cgQD2KqCTteJ3wkDqgg1qSApQSEl4AbaYEVPnxcUDpOknWEUrTAOrv6YwCNM4JiqlOO+5eekJTA9rdSSigQXxOB6j665MBtc9MKj6aKROgx8VSUKV1KSmgjcwnvZPKHfUCmqwMauMzI6DWpeb6Muhpl3D2pGYBFDhWBHzLxTCm0oA2uQBtpDup5In2MmgcoAbR0zTD6XGy7dGAWheM17o6Pz/yJ6BpBosEG01iXB5PB2jQ0XpC6oBy+QaLRAKqfW1eQO1lUEgKmn9OkoASUpGPATTIGRZTAKo20AOcASF3zSmnyN3NWTwhM6YMaiqFZgbUtDMD1Pp8kYKzOmEpp8HokgQoyOlsaAIAOmj/5H8laqjXxzExMZLUahJ37gsFx7QA2tj4zAcooBafHVBg2VM3usTJlEfYuZzupvpgQEUun6oWb/lDBnQ1cAbzKVeShpdDZBRmRqdsB80NKLT2rhldMo79zA+oIDQpoErBc1AK5Tm8A9DwmKtefFOfxRsJnbQnqRyg6XqSygPaTAMokxHQwCp8YwSUfyk5TVs/Z4OAGo0uBQM6ugxqyOO9MV1yAmomVHdGAmpIQjcY0NA8nhp9w0X6KpIxZKjCK0m8Kp+lDAoFNJBPOaYLUM/RGr+5VkAlKEPKoO4M2TYLyXN0jq/0A2rik3yQqBYvyQiofPBqFh8b01IGDT1avr1SQEOal2SjE1DrNDlvGdT6nXMC1Drdgx9+QkD7P2f8ZJH8gIYR2lqeV8Bln8fpOLphpdV0sGaVB7QxMyqOHwGdB6C27VY+8wG6JlGff5SwDDqUuxiapAzKEmT2jeT/jQQ0tAVUGCGAGiryfkAdMW1igO7ogHqdbnGjKbE0AbpSAaVkjgKUfyf7fxMBZWQGE9qVQe07xADqaRbwA2pa4cMX06nOqA2lFx8O9u9/YMTJ0ERAR0luALU/piFCjNA8z2nQ1AGa6+v5UGXtM3W3Lgfgf/bd8KOe18C+UwCa4lkNiiYA1PNDUn5zCqAhRpeOu8fYmR5y4z06ay7vL4NaFD8xXk1BB5M9hgmoUkJpY7rh5ZjK9zZ9GdTayFRRChp0MaLLoHbZcne/s3E1DkB6kkwa8egGC6C7DkB7ZypAe3UN9RFOtr0+QBmVEdV4AKCWJ4HmAHRHVJJMG0cDCktA1X4fUQZNBijP4jepoZ5zmQfQCGczFlANREfdHqAgQBVCmTOCT9tprqYBlA23s46TLwSob00Pw+F3rxpLjrRTdZrlamkyO2nl3Qrozs4oQmlIQ4ZuHizSKIDG1OBFTPkr++/ODKhyrBzQL52TiEsAeg6aCG+8FjpNpiHKJqdFokkF7GTwSe2ghs2JAAXsLwDlmXs4n1pDfXcxJEBBTtN2Ny3qr2kWgAbO85DPlfwnsjTB03Ff/LQR6gfUloaOAzSK0FBAmy7Jiyt9SjGlb5OSUAoo0GnaXh+gbUTuzo2GAYvW/s2h06bkgLImpnGAOtY0tmiVGtAuZ5kCUFoGBa00lxPQYEIzAeok1F4GbeyVJL5PHKFSVycYUHLwI/g0lUH5NcnckzS/MmjTxubxchnUAqjTaZWDUEhfvCUm2xYOqQgZxmdHaGCwYczBV+YH1LTzTMqgkYA2aj1JaqCPbmbSUmWPk0EHAjQiGY3oxF9JhI7P4qVv3GhA4Q5++PyNln4241JQPsAMCOiOWga1xpwI0BhCZwYoLYNa5x3PH1AJJvsYULPTrlBAWTuo42hHpaBB9SPechnZz9nYABW1+BDncHsEoB6VKoPCHdwovacX8FgTwGmVpwzagyYB6jra2LYmEjKwBs8kjWQKtVrKoORlAwGNbGXSAAXzGT82s3fKqIUBGh4yuImJKT2g5Ae7YYCSAaDAXfXDl94LPn3FT80JF7lBRkDZX947F9nO1IY10veKG6vMYmqfiErjZgEambl3hy//wdPPfIDSG6QCqhAKvHPG5lWX2kg+aSWpaWJ6Ok0XaCMBja4fscPv3/YJaCZAeR1WKYNKhIIBNTevutTG8Glrx4XGtH3lZgEa3QLaHb54ZyiAAp1ArXRAtUw+G6ChVfimP95AmxTT/KUNAhogB6Bgp0f8HosbPsji+XOUyUs+QMOVBVCmygClC3ndvqYreF2/uP/wYwygkH1Nh89eVqYmJpDTK3GTxe3mTpVP0ZPki7neM6oMGuYYncMvCNAP99lSiJ8e0nVlP3wTAui4OtKgL16uICUHtDECqr4F3LmoenxkDUktjwRqMYBe/enPL9vrH+gCneTl6ruia3USyUlF6RS0f9tkBjSqEIqA3v7yd7oc928ki+9X5f7dWpBvTjILnt2KTsdkBvxxumnwXc1opQShYoTyt+SF3DnP1/WeABnmw/ulH3AqAU4zXLkA/fCcrhf/VKx2zFflBqWgXf4+tqE+oqwVEFLU3wcPjNNb6h1JC9mTl0FDjzWumUntVQiPad9UUwq6ppICypLOPgUtC2heJwxQd08SSzjjDlV0dUY542NaVROgH+4TPb/+kZIZWgY9nz2gq37dDOlhHVzwrs6xgEY0hHJnfEybJhtuZ13d0N/MdPKSJabPQ2rxogY/W0AZl1ZAZYUAWqIdNKMzM6DKhFEO6IgByxTQ6xf3v34X2g4qGkHnDagss3OnmxIHKYM2ES31GwWo+uj7BIBa5b0GohupHkBXJqcoi8IHi4QRioBONOUjA6D+Tk6b0ygZTQ6oVg/PCyhpX4Luaw2Z1DkFoKQMul0c0KZjNB2gkG54s9MmDVC9qT0U0KA8Pm6gnRYypbOyMmgooIPOzbRl0OSAyqVP9r+hL4h/AL5z3TcCMI0dqqyFTOhc9qzO817gU7Kf6/CD1IAacmNjCsreBAIKSUgR0AkBFYRWUAaVnNYcHgEFxdxsQBM7VzqhmjMCUOlRMp4DGMfnYgD1KEMZVEF0voAaktAkgIov98XHFLQ4oIZEdMaA6iN/hXOHP2cpvAwKl+GxtSFCQGMAlVdFAp2S/VxjjWFOziclleG406vfLwOgI5NQBDQCUJ529kno3AHtxPnkqx2OAhTYEkrQRECLAtpn7vMfLKJK8DmQ2CHgzmmNA2YxNrEMOgGg4i3glKKvRVqnDmgzFlAXoX3iuVFdnZCd8wOqvq0E0GYI6PDZDRGA2gnd7etHCGhJQBuevfO39QBKNMjXYwH1EyrV3xHQooAS5erqLOKUmYwG1JvJS7V3BHQaQCvoSbI4VULFpoSAShk8AjoZoJzQ2gA1DGiiSlQG3VWFgGYC1Ck+VLkyrehUcwoo/0h6C58w3tHJv1DRgM/A6fAFVNW8+PCQnSrpi1fVpXm2WlLQYBHrgKYhoJiCTgJoUzGg2nOZgvviefbuArQfTI+AXt4jC3zQQXef/6CveZylDNpUWAZNBijv6ew5lbb1HUcbWYtXR99yQO++7QC9eKJPj08OqNrKVA+g5OJ1tXhTHh9x50ADQzcK0MHYsQ7QL/9jmwF689PfHmtLdiKgQ6dci48pg6oyAip1wCOgazSPDiigl1+9P9LW80JAYc7IO6e2N3VgykOYlnGaYnscoJ8fvyeAnu61F9r84zxlUPgp2c811jirOzfkk4K5sYCay6AUzfX/N4dbW1t3hxOUCizHHacF3Llhg71cgd9MQE07s9LnX798u87h21bL4xFQmDP8zukdSmoLqDekRzM5TXV7JKC0Kn9K2NTyeAQU5gy+c6b+Tp3P6k9zsD0W0Pb07n//TF61plAEFOaMBpQQqrR+Ygrq3HkoBBTmHAOoRCQC6tsZAY1zxpdB1dmbCKhnZwQ0zhl351RAOZdYBnXsjIDGOeMBXQ3GL4FDejSj0+y3I6BTOeMBHQ6wA4f0aEan2W9HQKdyjgVUtM8PIF3Eafbb0wsBhTnjuzrVEaDDZHQZpym2pxcCCnNG3Tk2sL7vgW/0xWOXcJrS9vRCQGHOEX3xSuETAQ2Uf50ksuLc1+/4CwIKd66USnz3IZZBEwLK14sn6l42GdAN0YhLWxhQul787S90BdnuBQFdvkZc2rKAsvXir1+s83bx0sLXi1+WpqamoKa+1Kr868V/+4Ykn91LtylJopTJiCnoSI24tEUB7daLpxqWQ5Pc80zGWTqNvUh5Q07hLApot148AprCiYCmB7RlzUyfHn5sb399170goFFOcz981pCTOKcAlKSkD96IFwQ0xmnlc44HO8JZGlCrClyMOV7/aCcHVMd0hgc7wpkYTiIEtIjT3BGfNeQUzsRwEiGgBZ0IaLgQ0IJOBDRcCGhJJ5ZBg4WATuus6mAR0BTGupxVHSwCmsJYl7Oqg0VAUxjrclZ1sAhoCmNdzqoOFgFNYazLWdXBIqApjHU5qzpYBDSFsS5nVQdbD6BwTTA7ZIoJKXiauYSA1hpzQ04TAa015oacJgJaa8wNOc3cgKJQo4SAomYtBBQ1ayGgqFkLAUXNWhkAvfruXUue5fTwI/3zE3ts4+1radpymZBXT/sHRmaP2U3Slj8oFHJ9mvdfOn3pY4qX7EoP6CdCBTn8D9+QP8kJkncn7BkQWWQOef39m/ZDNloGMVv2sErlgzIhyWmSJ2eVjNm/ZFdyQE8e/Nuaj+sf3hFO6M+PEkM+yCVLyKtnH9tsYfWY9GGV3QclQ34i5JxkosUSU7zkV6YsnsLxPf9Zr399V89+y5zFayHzpqDDmOxhlepBFAlJlC+kJWYfOrcyAUpyc37Vrp6uybx6yu5eHhlD5i0PDmOyh1XKB1EoZEvKg88zRbTFFKGzq0gKun5XNGnpQq4LZp/y1ZLUmN3DKkuepng+5vWLfHxaT7NyQAdlsZOX1z/mvnNayLyp2SBm97DKnGVQS0iaOeWTMab8aM7MygQoyXRYvY9jcpI7i9dCFkhB+5gta3hRPigTMi+f5phtzc1McssZbfBhz21cf5AXFj3kp/sZ62XDmIXbQfuQLDXLRov5NKsGFIVKJwQUNWshoKhZCwFFzVoIKGrWQkBRsxYCatbN4RbT9uXvX13eu/t2/dnnR1+855+TD07Xr3deSbu25LO99f+6Yb0fKkYIqF1rNNn/l/coX5f3CG97fPMpgfBi66DflXD9hHyqG+jOqHAhoHZJgD4hlJ0+kQG9OaRoHn3xvu0Bvbj7n/cOCJlDw+dHB+VPYAlCQO2SAP2Xx+/bm5/+ogK6N9yV4Pq/h9sE0KEBAY0UAmqXBOi//vy2vfzqH0oWf7G1tafuusZwj2bmuuEIs/g4IaB2SYAenB60F3sXfSWJFSy7mpEA9ILCedDqBuQzUgioXTKgF9vt0cGFkoJSkYq62LU92iZZ/3brMKDChIDaJQP6+fH//PGtiTexU0to7VJLlwEVJATULhnQ9t//st0qvHWJpgwoa0ta7200oGKEgNqlAEpa4FXejkhbJ8nQ+a7d+/WL2YCKEAJqlwIo+UOqJBE4T0Vtie1KdiM6vfNX2YCAjhECipq1EFDUrIWAomYtBBQ1ayGgqFkLAUXNWggoatZCQFGzFgKKmrUQUNSs9U/41Nkp+2fuVQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>In real life weâ€™d want to correct the faulty metadata at its source.
Here, weâ€™ll just change the values programmatically and re-match:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>metadat<span class="sc">$</span>Obs_length[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">45</span>, <span class="dv">45</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>dat<span class="sc">$</span>metadat_row <span class="ot">&lt;-</span> <span class="fu">ffi_metadata_match</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">data_timestamps =</span> dat<span class="sc">$</span>TIMESTAMP,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">start_dates =</span> metadat<span class="sc">$</span>Date,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">start_times =</span> metadat<span class="sc">$</span>Start_time,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">obs_lengths =</span> metadat<span class="sc">$</span>Obs_length <span class="sc">+</span> <span class="dv">10</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 1 entry had no timestamp matches!</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>dat<span class="sc">$</span>Plot <span class="ot">&lt;-</span> metadat<span class="sc">$</span>Plot[dat<span class="sc">$</span>metadat_row]</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>p <span class="sc">%+%</span> dat</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>That looks better!</p>
</div>
<div id="unit-conversion" class="section level2">
<h2>Unit conversion</h2>
<p>Weâ€™d like our final units to be in Âµmol/m2/s, and so need to do some
unit conversion. (This can happen either before or after flux
computation, below.) The package provides <code>ffi_ppm_to_umol()</code>
and <code>ffi_ppb_to_nmol()</code> functions that perform this
conversion using the <a href="https://en.wikipedia.org/wiki/Ideal_gas_law">Ideal Gas
Law</a>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>dat<span class="sc">$</span>CO2_umol <span class="ot">&lt;-</span> <span class="fu">ffi_ppm_to_umol</span>(dat<span class="sc">$</span>CO2, </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                                <span class="at">volume =</span> <span class="fl">0.1</span>, <span class="co"># m3</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                                <span class="at">temp =</span> <span class="dv">24</span>)    <span class="co"># degrees C</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; Assuming atm = 101325 Pa</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; Using R = 8.31446261815324 m3 Pa K-1 mol-1</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co"># See the message: because we didn&#39;t provide the &#39;atm&#39; parameter, </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># ffi_ppm_to_umol assumed standard pressure.</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co"># Also normalize by ground area (0.16 m2 in this example)</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>dat<span class="sc">$</span>CO2_umol_m2 <span class="ot">&lt;-</span> dat<span class="sc">$</span>CO2_umol <span class="sc">/</span> <span class="fl">0.16</span></span></code></pre></div>
<p>Note that in the example above weâ€™re using a <strong>constant system
volume and measurement ground area</strong>. If thatâ€™s not the case,
there should be a column in the metadata providing the changing values
(e.g.Â giving volume in m<sup>3</sup>) for each measurement. Then after
calling <code>ffi_metadata_match()</code>, merge the data and metadata
and pass the appropriate column to <code>ffi_ppm_to_umol()</code>.
Hereâ€™s an example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Let&#39;s say volume varies by measurement; this can happen if the chamber</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># height changes depending on the ground vegetation in each plot</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>metadat<span class="sc">$</span>Volume <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># Merge the data and metadata</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>dat_changing_vol <span class="ot">&lt;-</span> <span class="fu">merge</span>(dat, metadat[<span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>, <span class="st">&quot;Volume&quot;</span>)], <span class="at">by =</span> <span class="st">&quot;Plot&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Unit conversion as above, but using the changing volume information:</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>dat_changing_vol<span class="sc">$</span>CO2_umol <span class="ot">&lt;-</span> <span class="fu">ffi_ppm_to_umol</span>(dat_changing_vol<span class="sc">$</span>CO2, </span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>                                             <span class="at">volume =</span> dat_changing_vol<span class="sc">$</span>Volume,</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                                             <span class="at">temp =</span> <span class="dv">24</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; Assuming atm = 101325 Pa</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; Using R = 8.31446261815324 m3 Pa K-1 mol-1</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># We still have constant ground area in this example</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>dat_changing_vol<span class="sc">$</span>CO2_umol_m2 <span class="ot">&lt;-</span> dat_changing_vol<span class="sc">$</span>CO2_umol <span class="sc">/</span> <span class="fl">0.16</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co"># Relative to the previous constant-volume example, our area-normalized</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co"># amounts (Âµmol) have now increased for plots B and E because</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co"># of their larger volumes:</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="fu">aggregate</span>(CO2_umol_m2 <span class="sc">~</span> Plot, <span class="at">data =</span> dat, <span class="at">FUN =</span> mean)</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;   Plot CO2_umol_m2</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; 1    A    11855.81</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; 2    B    11908.15</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; 3    C    11787.88</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; 4    D    11776.09</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; 5    E    11974.30</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; 6    F    11976.25</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="fu">aggregate</span>(CO2_umol_m2 <span class="sc">~</span> Plot, <span class="at">data =</span> dat_changing_vol, <span class="at">FUN =</span> mean)</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt;   Plot CO2_umol_m2</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; 1    A    11855.81</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; 2    B    23816.30</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt; 3    C    11787.88</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; 4    D    11776.09</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; 5    E    35922.89</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; 6    F    11976.25</span></span></code></pre></div>
</div>
<div id="compute-fluxes" class="section level2">
<h2>Compute fluxes</h2>
<p>The <code>ffi_compute_fluxes</code> function provides a
general-purpose tool for computing fluxes from concentration time
series, as well as associated QA/QC information. It returns statistics
for four types of models: <em>linear</em>, <em>robust linear</em>,
<em>polynomial</em>, and <em>HM81</em>, an exponential model derived
from diffusion theory, following <a href="http://dx.doi.org/10.2136/sssaj1981.03615995004500020017x">Hutchinson
and Mosier (1981)</a>.</p>
<p>Model statistics include Akaike information criterion
(<code>AIC</code>), R squared (<code>r.squared</code>), standard error
of the residuals (<code>sigma</code>), and model p-value
(<code>p.value</code>). For the robust linear regression only, a logical
value <code>converged</code> is included; see the documentation for
<code>MASS::rlm()</code>.</p>
<p>Flux (slope) statistics estimate and std.error;</p>
<p>For the robust linear regression model only, a logical value
converged.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fluxes <span class="ot">&lt;-</span> <span class="fu">ffi_compute_fluxes</span>(dat,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                             <span class="at">group_column =</span> <span class="st">&quot;Plot&quot;</span>, </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                             <span class="at">time_column =</span> <span class="st">&quot;TIMESTAMP&quot;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                             <span class="at">gas_column =</span> <span class="st">&quot;CO2_umol_m2&quot;</span>,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                             <span class="at">dead_band =</span> <span class="dv">10</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: HM81_flux.estimate is not NA, implying nonlinear data</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: HM81_flux.estimate is not NA, implying nonlinear data</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: HM81_flux.estimate is not NA, implying nonlinear data</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># By default, ffi_compute_fluxes returns a data.frame with one row per</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co"># grouping variable value (i.e., per measurement). The first column is the</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co"># group label; the second is the average value of the `time_column`;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co"># and the rest of the columns are fit statistics for a linear fit of</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co"># concentration as a function of time, along with information about polynomial</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co"># and robust-linear fits. See ?ffi_compute_fluxes for more details.</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">names</span>(fluxes)</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;Plot&quot;               &quot;TIMESTAMP&quot;          &quot;HM81_AIC&quot;          </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;  [4] &quot;HM81_RMSE&quot;          &quot;HM81_flux.estimate&quot; &quot;HM81_p.value&quot;      </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;HM81_r.squared&quot;     &quot;lin_AIC&quot;            &quot;lin_RMSE&quot;          </span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; [10] &quot;lin_flux.estimate&quot;  &quot;lin_flux.std.error&quot; &quot;lin_int.estimate&quot;  </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; [13] &quot;lin_int.std.error&quot;  &quot;lin_p.value&quot;        &quot;lin_r.squared&quot;     </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; [16] &quot;poly_AIC&quot;           &quot;poly_RMSE&quot;          &quot;poly_r.squared&quot;    </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; [19] &quot;rob_AIC&quot;            &quot;rob_RMSE&quot;           &quot;rob_converged&quot;     </span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt; [22] &quot;rob_flux.estimate&quot;  &quot;rob_flux.std.error&quot; &quot;TIMESTAMP_min&quot;     </span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; [25] &quot;TIMESTAMP_max&quot;</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co"># For clarity, print out only a subset of the columns </span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>fluxes[<span class="fu">c</span>(<span class="st">&quot;Plot&quot;</span>, <span class="st">&quot;TIMESTAMP&quot;</span>, <span class="st">&quot;lin_r.squared&quot;</span>, <span class="st">&quot;lin_flux.estimate&quot;</span>, <span class="st">&quot;HM81_flux.estimate&quot;</span>)]</span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt;   Plot           TIMESTAMP lin_r.squared lin_flux.estimate HM81_flux.estimate</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; 1    A 2022-10-27 10:36:15     0.9486012          4.862042           4.794940</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; 2    B 2022-10-27 10:37:54     0.9467074          4.024164                 NA</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; 3    C 2022-10-27 10:39:24     0.6002940          3.967315           4.483758</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; 4    D 2022-10-27 10:41:02     0.9560099          6.463719                 NA</span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; 5    E 2022-10-27 10:42:32     0.9825172          6.680752                 NA</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; 6    F 2022-10-27 10:43:54     0.9512708          7.231148           6.261085</span></span></code></pre></div>
<p>Note that the <code>fluxes</code> extract printed above has one row
per <code>Plot</code>, the grouping variable; the mean
<code>TIMESTAMP</code> of the group; model statistics such as
<code>lin_r.squared</code>; and the flux estimate. The final column,
<code>HM81_flux.estimate</code> is only numeric (i.e., not
<code>NA</code>) when the data show evidence of a saturating curvature.
So in this case we might want to examine more carefully the data from
plots A, C, and F.</p>
<p>Plotting our computed fluxes:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(fluxes, <span class="fu">aes</span>(Plot, lin_flux.estimate, <span class="at">color =</span> lin_r.squared)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lin_flux.estimate <span class="sc">-</span> lin_flux.std.error,</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                     <span class="at">ymax =</span> lin_flux.estimate <span class="sc">+</span> lin_flux.std.error)) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;CO2 flux (Âµmol/m2/s)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We might want to check whether the robust-linear slope diverges from
the linear fit slope, suggesting influential outliers, or whether the
polynomial R<sup>2</sup> is much larger, potentially indicating
curvature of the observations due to e.g.Â diffusion limitations.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(fluxes, <span class="fu">aes</span>(lin_flux.estimate, rob_flux.estimate, <span class="at">color =</span> Plot)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">ggplot</span>(fluxes, <span class="fu">aes</span>(lin_r.squared, poly_r.squared, <span class="at">color =</span> Plot)) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_abline</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="46%" /><img src="data:image/png;base64,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" width="46%" /></p>
<p>The plot C (green) data have more scatter, and thus lower
R<sup>2</sup> values and higher uncertainty on the computed flux, but
thereâ€™s no strong evidence of nonlinearity or outlier problems (although
see note above about the <code>HM81_estimate</code> field).</p>
</div>
<div id="a-clearly-nonlinear-case" class="section level2">
<h2>A clearly nonlinear case</h2>
<p>In our experience, static-chamber fluxes are frequently linear (<a href="https://doi.org/10.1016/j.soilbio.2009.12.004">Forbrich et
al.Â 2010</a>) even though molecular diffusion means that chamber
feedbacks will inevitably lead to curvilinear (saturating) behavior over
time (<a href="https://doi.org/10.1111/j.1365-2389.2010.01291.x">Pedersen et
al.Â 2010</a>).</p>
<p>Still, how does one use <code>fluxfinder</code> to diagnose and work
with nonlinear data?</p>
<p>Letâ€™s use Râ€™s built-in <code>Puromycin</code> dataset (simply because
it exhibits saturating behavior; itâ€™s unrelated to greenhouse gases) as
an example:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(Puromycin, <span class="fu">aes</span>(conc, rate)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Visually, we can see that a linear model will not be appropriate in
this case.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ffi_compute_fluxes</span>(Puromycin,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                   <span class="at">group_column =</span> <span class="cn">NULL</span>,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                   <span class="at">time_column =</span> <span class="st">&quot;conc&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                   <span class="at">gas_column =</span> <span class="st">&quot;rate&quot;</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: HM81_flux.estimate is not NA, implying nonlinear data</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt;        conc HM81_AIC HM81_RMSE HM81_flux.estimate HM81_p.value HM81_r.squared</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; 1 0.3121739 200.9997  17.56084           246.1399 9.406055e-11      0.8696062</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt;    lin_AIC lin_RMSE lin_flux.estimate lin_flux.std.error lin_int.estimate</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; 1 223.7834 28.81711           105.398            16.9191         96.03154</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;   lin_int.std.error  lin_p.value lin_r.squared poly_AIC poly_RMSE</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; 1          7.780867 3.525876e-06     0.6488706  205.746  18.76394</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt;   poly_r.squared  rob_AIC rob_RMSE rob_converged rob_flux.estimate</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; 1      0.8653059 223.8119 24.79301          TRUE          106.2137</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;   rob_flux.std.error conc_min conc_max</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; 1           20.65072     0.02      1.1</span></span></code></pre></div>
<p>From the diagnostics returned by <code>ffi_compute_fluxes</code>:</p>
<ul>
<li><code>HM81_flux.estimate</code> is not <code>NA</code>, which only
occurs with saturating behavior;</li>
<li>The <code>lin_AIC</code> (223.783) and <code>rob_AIC</code>
(223.812) <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">Akaike
information criterion</a> values are similar, so no indication of
influential outliers;</li>
<li>The <code>lin_r.squared</code> (0.649) and
<code>poly_r.squared</code> (0.865) values are <em>very</em> different,
suggesting a failure of the linear model;</li>
<li>The <a href="https://en.wikipedia.org/wiki/Root_mean_square_deviation">root
mean square error</a> (RMSE) of the linear model is much higher than the
other modelsâ€™ values;</li>
<li>The <code>HM81_r.squared</code> (0.87) and <code>HM81_AIC</code>
(201) are considerably higher and lower, respectively, than the linear
model.</li>
</ul>
<p>All of these metrics point to a common conclusion: a linear model is
<em>not</em> appropriate for these data. If these were real data, we
should use the <code>HM81_flux.estimate</code> value as our flux
estimate.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>This vignette covered <code>fluxfinder</code> basics: loading data
and metadata, matching the two, performing unit conversion, computing
fluxes, and some basic QA/QC. The test data we worked above could be fit
well by linear model, but for many reasons this might not always be
true; see the vignette on <a href="integrating-gasfluxes.html">integrating with the gasfluxes
package</a> for guidance on using more sophisticated model-fitting
routines.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
